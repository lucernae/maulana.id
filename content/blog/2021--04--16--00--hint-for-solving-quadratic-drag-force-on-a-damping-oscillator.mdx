---
layout: blog-posts
title: Hint for solving quadratic drag force on a damping oscillator
description: My thought process on trying to solve the differential equation
date: 2021-04-15T23:45:27.301Z
---
As an appendix promised for the article [How fast helium balloon floats...](https://maulana.id/blog/2021--04--11--17--how-fast-helium-balloon-floats/), I’m going to explain the hint on how to derive the insights behind the quadratic drag force presents in the damped harmonic oscillations found in the previous articles.

Solving the usual damped oscillations is simple enough because it’s linear. Meanwhile, the quadratic force is not so straight-forward. Originally, I didn’t find any open literature that discuss this. There are several articles found online with the keyword “Quadratic Drag Force Damping Oscillator”, but most of it is behind a paygate, so I can’t access it. Some of the article I found, only discuss a falling object under drag force. That one is also simple, but way different from the case of quadratic damping found in the oscillator.

So, at that time, I have no choice but to try to solve it myself. Perhaps there is a better way? In that case, let me know.

# Looking at the equation of motions

The equation of motions can be found from a simple Newton’s Law. But there is a tricky catch.

We first introduce an oscillator with position $x(t)$ measured from it’s equilibrium position.

This is a damping oscillation with all linear order of position $x(t)$:

$
\ddot x=-\omega^2 x - D_1\dot x
$

Meanwhile, this is a quadratic damping of the same oscillation:

$
\ddot x=-\omega^2 x - D_2\dot{x}^2
$

All the second terms corresponds to the drag force, with each drag constant ($D_1$ and $D_2$) so that we remember that the dimension is different between each equations. However, we should be careful because in the case of linear damping, the information about the direction of the drag force is conveyed entirely in the expression. Meanwhile for the quadratic damping above, it is only valid if the direction of the movement is $\dot{x}\ge0$ or into the positive axis.

It is not complete. We should also observe the equation when the velocity is pointing to the opposite direction.

$
\ddot x= -\omega^2 x + D_2 \dot{x}^2
$

As you can see, the sign alternates. More compactly it can be written:

$
\ddot x = -\omega^2 x - D_2 \dot{x} \left| \dot{x} \right|
$

But we still need to solve both separately.

# Separating the variables

Both quadratic damping equation is difficult to solve directly.

Usually, from the equation of motion we convert it into an energy equation like this:

$
\ddot x=-\omega^2 x - D_2\dot{x}^2 \\
\dot x \cdot d\dot x=-\omega^2 x \cdot dx - D_2 \dot{x}^2 dx
$

But the second term in the right hand side is difficult to integrate. Even if we can, we still need to separate the variables to further integrate it to retrieve the time function of x $t(x)$.

Instead of that, I offer an alternative approach. We know that the derivative of $\dot{x}^2$ will be somewhat linear in power (not quadratic). So instead of integrating the equation of motions, we took a derivative instead.

$
\frac{d\ddot{x}}{dt} = -\omega^2 \dot x - 2D_2 \dot{x} \ddot{x}
$

I couldn’t find a way to express triple dot in Katex, so the above notation will do. Notice that the right hand side has common $\dot{x}$ and it could also be “chain-rule”’d so that we eliminate $dt$. Here’s the differential form.

$
d\ddot{x}=(-\omega^2-2D_2\ddot{x})\cdot dx
$

The above form is integrable and separable if we move the right hand terms with $\ddot{x}$ to left hand side. The above expression is for $\dot{x}>0$. For $\dot{x}<0$, it’s similar with following the same reasoning.

$
d\ddot{x}=(-\omega^2+2D_2\ddot{x})\cdot dx
$

By integration we have the following relations

$
\dot{x} > 0; k_+=e^{2D_2x}(\omega^2+2D_2\ddot{x}) \\
\dot{x} < 0; k_-=e^{-2D_2x}(\omega^2-2D_2\ddot{x})
$

A constant $K_+$ is used when the object oscillates with positive velocity, up to a half cycle. After that the velocity is zero and it will return back with negative velocity, in which we use $K_-$ for the remaining half cycle. To get these constants, we can use initial condition. But since each initial condition is calculated from the start of the half cycles, we can infer that each constants will have different values and probably have a pattern for even-half-cycles and odd-half cycles.

We can retrieve relations between (only) $x$ and $\dot{x}$ by substituting it back into the previous equation of motions.

$
\dot{x} > 0; k_+=e^{2D_2x}(\omega^2 - 2D_2 \omega^2 x-2 D_2^2 \dot{x}^2)\\
\dot{x} < 0; k_-=e^{-2D_2x}(\omega^2 +2D_2 \omega^2 x-2 D_2^2 \dot{x}^2)
$

Because we have relations between $x$ and $\dot{x}$, we might understand more if we create a phase space diagram. By drawing a phase diagram, you can understand more about the cycles of the oscillator.

If we treat $x$ as the horizontal axis, and then $\dot{x}$ as the vertical axis, then we can set that the oscillations happens when maximum displacement starts. Let’s start with negative x.

Before we proceed, I just wanted to note that I should’ve made a good diagram, but I haven’t found a good math graph library yet for React + MDX, so maybe I’ll do that later. Anyway, it should be straightforward to draw the phase diagram if you set some initial conditions.

We can avoid setting initial conditions by using unitary quantity. Let’s just introduce a new dimensionless variables for both $x$ as $X$ and $\dot{x}$ as $V$. The new variables have maximum absolute value of one. Because of this, the constant will also change unit/dimension to match, so we renamed it as $K_+$ and $K_-$.

We substitute this:

$
X=2D_2x \\
V^2=\frac{2D_2^2}{\omega^2}\dot{x}^2 \\
K_+=\frac{k_+}{\omega^2} \\
K_-=\frac{k_-}{\omega^2}
$

The phase space relations conveniently becomes:

$
V > 0; K_+=e^X(1-X-V^2) \\
V < 0; K_-=e^{-X}(1+X-V^2)
$
